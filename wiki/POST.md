// https://leaskh.com/post/648386067099205632/%E9%97%9C%E6%96%BC-starlink%E4%B8%80%E4%BA%9B%E4%BD%A0%E6%83%B3%E7%9F%A5%E9%81%93%E7%9A%84%E7%B4%B0%E7%AF%80

關於 Starlink

早在 2020 年，SpaceX 就開始推進 Better Than Nothing Beta 測試計畫。2020 年下半年，美國不少符合要求的地址收到了設備。到 2021 年春天，加拿大南部地址的申請陸續通過。我就是在這個時候拿到我的天線，開始體驗。這個過程中，深入了解了這套系統的工作方式以及一些背景資料。一番思索之後決定寫出來，給想折騰或者感興趣的朋友一個參考。整理這些資料的另外一個原因，也是因為很多人對於 Starlink 項目存在一些誤解，有無腦黑的，也有期望過高的。有覺得馬老闆有關的項目都是騙人的，有拿著很多年前 PPT 上老版本規劃數據在吹噓的，也有各種不切實際的盼望衛星接入會在短時間內給人類社會帶來諸如蒸汽機般產業革命的。因此作為早期的用戶，我希望通過一些我的整理和分析，給大家更全面和稍靠譜的認知。


現狀

Starlink 目前計畫先發射 12000 顆衛星。其中 1500 顆在 550 KM 軌道，2800 顆 在 1150 KM 軌道，7500 顆在 340 KM 軌道。完成這個階段之後，將會安排另外 30000 顆，最終達到 42000 顆衛星，組成全球覆蓋。Starlink 平均每週會進行一次發射，到撰文當日為止在軌衛星有 1320 顆。每單顆衛星可以有效覆蓋 2 經度 * 2 緯度 的地表區域，當前主要有效覆蓋集中在美國高緯度和加拿大低緯度地區。在這一緯度區域的部分歐洲國家用戶也開始陸續收到邀請。更多關於衛星相關的資料可以查閱 Wikipedia。



速度

很多人關心 Starlink 的實際速度。這個問題比較複雜，Starlink 最新的目標速度已經從 1 Gbps 提升到 10 Gbps。當然，這估計需要等全部四萬顆衛星在軌才能實現。目前計畫中最近一次提速預期會發生在 2021 年下半年，計畫速度會穩定在 300 Mbps，延遲控制在 20 ms 左右。以上都是畫餅，目前各地用戶的實際速度参差不齐。Raddit 上有一個愛好者整理的測速列表，可以看到各地用戶的實際連接速度，作為參考。總體來說，目前信號比較好的地區可以實現 200 Mbps 下行，50 Mbps 上行，15 ms 延遲。我自己的測速基本上符合這個結果，但是我所在的地區，延遲會相對大一些，平均 40 ms。Starlink 近期已經在測試提速能力，在信號特別好的時候，我測試到最高速度已經可以跑到 400 Mbps 左右。


軌道

Starlink 所使用的 LEO（Low Earth Orbit，近地軌道）方案是與其他民用級衛星上網方案的最大區別。後來者 Amazon 的方案也學習了這一設計。於大家熟知 35786 KM 的 GSO（Geosynchronous Orbit，地球同步軌道）不一樣。大部分人造衛星工作在 GSO，這是因為在這個軌道上衛星的旋轉角速度與地球同步，故稱同步軌道。同步軌道上，衛星相對地球是靜止的。所以星歷的調整，地面通訊站的對準等都相對容易，缺點是距離遠，通訊需要的功率比較高，因此就需要收發功率和體積都比較大的重型天線設備。需要考慮接收設備體積和效率的方案中，都會傾向於採用更低的軌道，例如我們熟知的 GPS，就使用了 20180 KM 的較低軌道。缺點就是更低的軌道單星覆蓋的地表區域更小，要做到全球覆蓋就需要更大規模的衛星群。而且更低的軌道上，衛星的旋轉角速度就需要比地球更快，用高速帶來的離心力來平衡地球衛星之間的萬有引力，才能讓衛星懸停在固定的高度。因此越低軌道的衛星，就需要更高的繞地旋轉速度。所以在沒有 A-GPS 的年代，傳統 GPS 設備在定位之前獲得星歷來計算位置，是相當耗時的，往往需要幾分鐘到十幾分鐘才能完成首次定位。Starlink 大量採用 340 ~ 550 KM 軌道，衛星旋轉線速度達到 17500 Mph，約每秒 7.8 km。所以繞了這麼多，需要理解的其實是，Starlink 用戶端天線在通訊時並非是連接單一衛星的，而是對準整條衛星飛行軌道，然後相控天線根據所同步到的星歷，精準與飛過頭頂的衛星收發信號。用戶請求的一個網頁，可能是通過頭頂飛過的若干個衛星分包傳輸回來，在天線內部緩存中拼接完再傳輸給用戶的。而不是很多人想的那樣，頭頂固定一個衛星，通過固定的鏈路實現通訊。這個設計增加了客戶端天線的複雜度，必須使用相控天線陣列才能實現，而不能使用傳統的定向衛星天線。這是因為相控天線陣列支持波束賦形，更容易對準滑過天空的衛星。Starlink 選了一個難度更大，但是更能帶來高帶寬和低延遲的方案。感興趣的話可以到這個網站：https://satellitemap.space/，了解 Starlink 衛星的實時位置。


鏈路

Starlink 設計了兩種鏈路。第一階段實現的是：

用戶 <=> 衛星 <=> 地面站 <=> 網站服務器，

以及目前正在演進的第二階段：

用戶 <=> 衛星 … 衛星 <=> 地面站 <=> 網站服務器。

第二階段的方案主要引入了衛星與衛星之間的通訊，這一階段通過衛星之間的激光束通訊完成。粗略看沒多大區別，但是這才是 Starlink 整個方案中對核心體驗帶來最大期望的一環。在第一階段中，用戶的訪問請求會經由衛星轉發到最近的地面站，流量通過地面站轉發到目標服務器，獲得響應之後原路返回。這個方案簡單，但是缺點很明顯，因為本質上和直接接入光纖沒有區別，而且還額外增加了用戶到衛星，衛星到地面站的延遲，完成一個迴路就需要增加至少 4 個額外的延遲環節。最終依然通過傳統光纖實現主要路由，走完由用戶到網站的物理距離。而且更差的情況是第一個地面站沒有適合的路由，只能把請求轉到另一個衛星，由另一個衛星從其他地面站落地，於是就會出現反覆在地面站和衛星之間跳轉的情況。目前 Starlink 整個方案中，通訊最慢的階段就是衛星和地面之間的這段，如果需要反覆在衛星和地面之間中繼，延遲將會徹底失控。第二階段方案中，網絡流量將通過頭頂的衛星在真空中通過激光束在衛星之間轉發，並在最接近網站服務器的地面站落地，主要通過衛星之間的激光路由走完物理距離。得益於真空中光速是光纖中光速的 1.5 倍，並且軌道上的衛星路由大概率可以得出距離更短，效率更高的轉發方案，因此最終延遲和帶寬都將比第一階段方案好，甚至可能優於傳統光纖接入。2020 年底開始發射的衛星已經具備星星間通訊能力，根據畫餅，完全星星間通訊實現以後，網絡延遲可以控制在 1.8 ms * 4 也就是 10 ms 量級。但是這要求衛星群覆蓋已經相當完善才有希望，目前距離所需要的衛星數量依然相當巨大。事實上目前有效工作的衛星主要集中在北緯度 53 度左右成鏈，這就是為什麼只有美加交界所在的地區可以獲得比較好的連接效果。另外，目前 Starlink 只能提供 IPv4 的連接方式，IPv6 據說即將開放，但是沒有看到有官方的時間表。

階段 1：https://www.youtube.com/watch?v=m05abdGSOxY


階段2：https://www.youtube.com/watch?v=oCKhl–raMs


設備

Starlink 的安裝相當簡單，你會收到一共 3 個主要設備：天線，電源，路由器。


天線雖然看上去和一般衛星電視天線差不多，但是裡面的結構很不一樣。一般的民用衛星天線是把信號反射到中央的接收器處理。Starlink 的天線不是一個整體，而是一個密集的天線陣列。對拆解感興趣的可以看這個視頻：https://www.youtube.com/watch?v=iOmdQnIlnRo。天線在通電之後，會轉動到水平位置，然後開始尋找衛星飛行飛軌道，找到之後會轉到到對應的角度，然後鎖住衛星飛行的軌道。在衛星軌道和天線的相對位置發生變動之後，天線會轉動尋找新的可用軌道。這個尋找耗時幾十秒到幾分鐘不等，所以目前的天線設計是不能掛在移動中的載具上使用的。有消息說針對載具設計的天線已經在開發中，可以支持在車，船，飛機上使用 Starlink 接入。Starlink 的天線運行 Linux 系統，有玩家已經有辦法連到調試串口上監控天線的工作狀態，有完整的啟動 log 可供研究。天線主機不單單完成衛星軌道的對準和追蹤，同時已經完成網絡連接，實現了 NAT，DHCP 等服務，相當於碟子內其實已經有一個小路由器。天線硬件經過了幾個版本的迭代，目前收到的天線硬件版本依然是 Beta，但是版本號已經比早期收到的用戶版本號更高。新版本的天線增加了電加熱融雪等功能。由於我收到的時候渥太華已經進入冬天的尾巴，沒有經歷過大雪天，我會在今年冬天的時候觀察一下融雪性能再補全此文。

Starlink 電源以 POE（Power over Ethernet）形式為天線和路由器供電，同時連通天線和路由器之間的線路。所以體驗上，只需要把網線接好，天線和路由器的供電就同時解決了。電源最高支持 180 W 輸出，常規工作消耗大概在 100 W 左右。

Starlink 路由器其實比較雞肋，它不是是個必須的設備，而且有傳言路由器會在往後的版本被去掉。Starlink 路由器和普通寬帶路由器區別不大，提供 Wi-Fi（802.11a/n/ac），以及一個 Ethernet 接口。你可以把自己的路由器接到 Starlink 路由器下面，當然你也可以直接把自己的自己的路由器接到天線上，然後把 Starlink 路由器扔掉。有一點需要注意，Starlink 路由器實現了一套 gRPC API，用以實時訪問天線工作狀態，包括信號強度，阻擋角度，阻擋強度，阻擋時間，衛星離線時間，Ping 健康度等等信息。實際上 Starlink 官方 APP 就是通過這組 API 工作的。我利用業餘時間開發了一個命令行的 Dashboard，用來監控天線的狀態，使用的也是路由器提供的這組 API。項目地址在這裡：https://github.com/Leask/Starlink-Signal-Status。如果你直接拔掉 Starlink 路由器，你將無法監控天線狀態。雖然在穩定安裝後，完全不用關心這些信息，體驗上和一般寬帶並沒有實質區別。


餅

衛星上網並不是 SpaceX 發明的。最早做相關探索的是 Iridium（銥星公司）。Iridium 最初設計 66 顆衛星，從 1997 年開始發射，2000 年破產，2001 年重組。重組之後的第二代銥星（Iridium Next）從 2017 開始由 SpaceX 發射，一共 75 顆，能提供給單用戶的帶寬只有 512 kbps。另外，始創於加拿大渥太華的 Telesat 公司提出過一種 298 顆衛星的接入方案，聲稱 2023 年提供服務。類似的方案還有英國 OneWeb 的 648 顆衛星的方案。OneWeb 也經歷了破產和重組，也在逐步發射衛星，打算在 2022 年開始提供服務。以上這些競爭對手無論衛星規模，所使用的技術，覆蓋範圍和速度，都和 Starlink 的設計存在較大的距離。真正能和 SpaceX 正面競爭的是來自 Amazon 的 Project Kuiper，該項目計畫發射 3236 顆近地軌道（590 KM / 610 KM / 630 KM）衛星，使用類似於 Starlink 的高頻相控天線陣列，設計單用戶速率 400 Mbps，但距離可以實際使用還需要至少 6 年時間。所以即便很多人不樂意看到 Elon Musk 畫餅，但目前消費級別衛星上網方案中，Starlink 是最可用，實際效果也是大大領先競品的，甚至費用也是最經濟的。當然，我說的只是民用級別的方案。顯然這的確是未來接入方式的一種可行的探索。有人誇大其詞說衛星上網會替代光纖和 5G。我個人認為這在短時間內不會實現，甚至永遠不會發生。除非衛星通訊的成本會有戲劇性的下降。在人口密集的區域光纖和 5G 的成本效益目前還是最好的。但在稍稍偏遠的區域，光纖的成本就會變得很高昂。這些地方可能會成為衛星上網服務更有競爭力的目標市場。但是恰恰是如 Amazon 這樣領域的公司參與近來，讓我覺得可能會給這個領域帶來一些新的可能性。理想情況下，將來衛星之間實現的路由有可能比地面路由總體距離更短，效率更高，所以也有人認為未來的骨幹網就在天上。但是這一切也還只是個餅。就目前這個規模，距離質變還有相當大的距離，甚至量變都尚未開始，各家只是剛剛開始探索而已。



缺點

我已經不只一次在 Twitter 上說過，我不建議大家現階段申請，Starlink 只會給你發一個快遞，一切的安裝和調試都需要自己搞定，你需要自己找到信號好的角度安裝天線，如果你沒有一個農場那麼大的院子，或者靠近河邊的豪宅，對於大部分人的房子，符合安裝要求的只有屋頂。我這裡說的屋頂是美加平民住宅區的屋頂，downtown 密集建築群基本上找不到符合條件的安裝地點。Starlink 目前需要地平線上大約 25 度以內不能有任何阻擋，包括樹梢都會讓信號劣化。這個很容易理解，高頻無線電波繞過障礙物的能力很差。除了安裝很折騰之外，原理上目前穩定性也不能和光纖媲美。還需要考慮可能的惡劣天氣，風雨雷電雪帶來的影響。對於普通人來說，目前更可靠和便利的選擇還是以光纖和同軸為介質傳統寬帶。以我所在的地區為例，120 CAD 月費正好等於 1GB 的寬帶月租。因此現階段，的確在用更多的錢購買一堆麻煩。因此我很難向別人推薦這種目前更接近玩具的連接方式，除非你願意折騰，並且覺得有 cool 的地方，能夠樂在其中。



中國

到底中國能不能用？當前並不能，但是我認為將來是可以的。目前官網上中國地址可以申請，官方預計 2022 開始邀請中國用戶測試。但是作為運營商，Starlink 在中國也有合規性問題，也需要符合中國的管治規定，我個人覺得 100% 是會自帶 GFW 的，有相關想法的，不要抱有任何一絲不切實際的幻想。有網友和我說，衛星通訊沒有辦法加防火牆，我只能說，這是對技術的無知，也是對社會無知。補充一下，中國也有自己的衛星上網方案，叫做虹云工程。由 156 顆衛星組成，2018 開始發射第一顆，宣傳說 2019 年首顆衛星到達軌道成功測試，單星已經比家庭寬帶還要快。需要注意的是虹云衛星運行在 1000 KM 軌道。這基本上是違反物理學常識的，認真看過前文就知道近地軌道需要穩定就需要更快的旋轉速度，那麼它對於地球就不是同步的，那麼單顆衛星是完全不可能提供上網服務的，所以，這讓中國新聞顯得一如既往的魔幻。



玩具

目前的結論是，我認為 Starlink 是一個很好的玩具，如果你對於衛星互聯網有體驗的熱情，想體驗一下不一樣的接入方式，你有一些折騰網絡的經驗，有能力解決一些實際問題，完全可以申請體驗。另外 Starlink 遵循 FCC 的規定，提供 30 天全額退款時間，如果發現你所在的地區速度和穩定性不理想，可以申請退款。但是如果你只是簡單希望一個靠譜的鏈路，找本地口碑好的運營商，申請一條光纖，同軸或者各種 DSL 是最簡單的可靠的方案，而且也不折騰，沒必要在現階段為一種探索中不穩定的上萬方案承擔風險，浪費時間，並且帶來可能的體驗劣化風險。Starlink 工程師在 Reddit 上開過一個 AMA 的帖子，裡面回答過很多用戶提出的問題，從系統的原理到現狀和展望都有，感興趣的可以前往閱讀或者提出新的問題。值得稱讚的是 Starlink 的工程師和客服響應都很快，無論是發帖還是郵件提問，都能很快得到回覆。


雕鳳凰

到撰文此刻，我家已經是 all in Starlink。我在本月早些時候，停掉了家裡的同軸寬帶，完全通過衛星接入。因為我家每個成員都有無限流量的蜂窩上網設備，連 6 歲兒子帶在身上的 iPad 都是蜂窩版的，我毫不擔心 Starlink 會偶爾 down 掉。事實上到目前為止，Starlink 並沒有出過任何問題，我所在的區域，只要把天線掛到屋頂沒有阻擋的地方，連接就十分穩定，並不需要為極端情況多養一條寬帶。前面說過，冬天可能是真正的挑戰，只能到今年冬天再看看是不是需要其他接入作為補充。但是，我依然建議大家如果想嘗試 Starlink 的話，保留一段時間自己原來的寬帶連接，至少運作幾個月到半年，再做進一步決定也不晚。反正不要期望過大，也不要無腦黑。其實好比當年 Steve Jobs 拿著一個呼拉圈來回套弄發佈支持 Wi-Fi 的 iBook 時一樣，Wi-Fi（802.11b）當年只有可憐的 11 Mbps。人們開始熱烈討論，有人認為這個神奇的技術只有可憐的 11 M，完全只是個玩具，也有人說這將徹底革命有線網，開始新的時代。然而兩家的言論都錯了，22 年後的今天，我們有了 10 Gbps 量級的 Wi-Fi 6E，Wi-Fi 成為了我們必不可少的接入方式，但是它也並沒有消滅有線網。先不說哪一家的衛星上網能最終贏得市場，但是我認為衛星上網大概率也是如此，它會找到自己的生存空間，成為一種新的接入補充，參與市場競爭，成為新常態的一部分。在這之前，不要像雕鳳凰故事中的路人一樣，妄下結論。
